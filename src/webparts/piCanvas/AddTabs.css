/* ===== CSS CUSTOM PROPERTIES (Defaults) ===== */
.addui-Tabs {
  /* Colors */
  --pi-tab-accent: #0078d4;
  --pi-tab-text: rgba(0, 0, 0, 0.7);
  --pi-tab-text-active: var(--pi-tab-accent);
  --pi-tab-bg: transparent;
  --pi-tab-bg-active: transparent;
  --pi-tab-bg-hover: rgba(0, 0, 0, 0.04);

  /* Typography */
  --pi-tab-font-size: 14px;
  --pi-tab-font-weight: 500;

  /* Spacing */
  --pi-tab-padding-v: 12px;
  --pi-tab-padding-h: 20px;
  --pi-tab-gap: 0px;
  --pi-tab-content-gap: 0px;

  /* Borders & Effects */
  --pi-tab-radius: 0px;
  --pi-tab-indicator-width: 3px;
  --pi-tab-indicator-color: var(--pi-tab-accent);
  --pi-tab-indicator-display: block;
  --pi-tab-separator-color: rgba(0, 0, 0, 0.12);
  --pi-tab-separator-display: block;
  --pi-tab-shadow: none;
  --pi-tab-transition: all 0.2s ease;
}

/* Disable transitions when user opts out */
.addui-Tabs[data-transitions="false"] {
  --pi-tab-transition: none;
}

/* ===== BASE TAB STYLES ===== */
.addui-Tabs .addui-Tabs-tabHolder {
  display: flex;
  gap: var(--pi-tab-gap);
}

.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab {
  flex: 1;
  border-bottom: 1px solid var(--pi-tab-separator-color);
  border-bottom-style: var(--pi-tab-separator-display, solid);
  text-align: center;
  padding: var(--pi-tab-padding-v) var(--pi-tab-padding-h);
  cursor: pointer;
  color: var(--pi-tab-text);
  font-weight: var(--pi-tab-font-weight);
  font-size: var(--pi-tab-font-size);
  transition: var(--pi-tab-transition);
  background: var(--pi-tab-bg);
  border-radius: var(--pi-tab-radius) var(--pi-tab-radius) 0 0;
  position: relative;
  overflow: hidden;
}

/* Tab image support */
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab .tab-image {
  max-height: 24px;
  width: auto;
  vertical-align: middle;
  margin-right: 8px;
}

.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab .tab-image.tab-image-right {
  margin-right: 0;
  margin-left: 8px;
}

.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab .tab-image.tab-image-top {
  display: block;
  margin: 0 auto 6px auto;
  max-height: 32px;
}

/* Tab background image support */
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab[data-has-bg-image="true"] {
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  color: #fff;
  text-shadow: 0 1px 2px rgba(0,0,0,0.5);
}

.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab[data-has-bg-image="true"]::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.3);
  z-index: 0;
  transition: var(--pi-tab-transition);
}

.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab[data-has-bg-image="true"] > * {
  position: relative;
  z-index: 1;
}

.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab:hover {
  color: rgba(0, 0, 0, 0.87);
  background-color: var(--pi-tab-bg-hover);
}

.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab[data-has-bg-image="true"]:hover::before {
  background: rgba(0,0,0,0.4);
}

.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.addui-Tabs-active {
  padding-bottom: calc(var(--pi-tab-padding-v) - var(--pi-tab-indicator-width) + 1px);
  border-bottom: var(--pi-tab-indicator-width) solid var(--pi-tab-indicator-color);
  border-bottom-style: var(--pi-tab-indicator-display, solid);
  color: var(--pi-tab-text-active);
  background: var(--pi-tab-bg-active);
  box-shadow: var(--pi-tab-shadow);
}

.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab[data-has-bg-image="true"].addui-Tabs-active::before {
  background: rgba(0,0,0,0.2);
}

/* Web part as tab label support */
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab {
  padding: 8px 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: visible !important;
}

/* Style web parts used as tab labels - remove all SharePoint chrome */
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab .as-tab-label,
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab .as-tab-label * {
  margin: 0 !important;
  padding: 0 !important;
  border: none !important;
  box-shadow: none !important;
  background: transparent !important;
}

/* Remove all container restrictions for web part labels */
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab .ControlZone,
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab [class*="ControlZone"],
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab [class*="controlZone"],
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab [data-automation-id="CanvasControl"],
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab [class*="webPartContainer"],
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab [class*="WebPart"],
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab [class*="webpart"] {
  width: auto !important;
  max-width: none !important;
  overflow: visible !important;
  padding: 0 !important;
  margin: 0 !important;
}

/* Target SharePoint image webpart containers */
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab [data-automation-id="imageWebPart"],
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab [class*="imageWebPart"],
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab [class*="ImageWebPart"],
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab figure,
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab picture {
  width: auto !important;
  max-width: none !important;
  display: block;
}

/* Images in web part labels - show full image, not truncated */
/* Label image height is configurable via --pi-label-image-height (default: 60px) */
/* When --pi-label-image-height is 'none', images fill the tab but stay within bounds */
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab img {
  max-height: var(--pi-label-image-height, 60px);
  width: auto !important;
  height: auto !important;
  max-width: 100%;
  display: block;
  object-fit: contain !important;
}

/* When no limit is set, constrain images to fit within tab while maintaining aspect ratio */
.addui-Tabs[data-label-image-unlimited="true"] .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab img {
  max-height: none;
  max-width: 100%;
  width: 100%;
  height: auto !important;
  object-fit: contain !important;
}

/* Handle Image web part specific structure */
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab [data-sp-web-part] {
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: visible !important;
}

/* Remove any clipping from image containers */
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab [class*="image"] {
  margin: 0 !important;
  padding: 0 !important;
  overflow: visible !important;
}

.addui-Tabs .addui-Tabs-content {
  display: none;
  margin-top: var(--pi-tab-content-gap, 0);
}

.addui-Tabs .addui-Tabs-content.addui-Tabs-active { display: block; }

/* ===== TAB ALIGNMENT STYLES ===== */

/* Stretch (default) - tabs fill full width */
[data-tab-alignment="stretch"] .addui-Tabs-tabHolder .addui-Tabs-tab {
  flex: 1;
}

/* Left alignment */
[data-tab-alignment="left"] .addui-Tabs-tabHolder {
  justify-content: flex-start;
}
[data-tab-alignment="left"] .addui-Tabs-tabHolder .addui-Tabs-tab {
  flex: 0 0 auto;
}

/* Center alignment */
[data-tab-alignment="center"] .addui-Tabs-tabHolder {
  justify-content: center;
}
[data-tab-alignment="center"] .addui-Tabs-tabHolder .addui-Tabs-tab {
  flex: 0 0 auto;
}

/* Right alignment */
[data-tab-alignment="right"] .addui-Tabs-tabHolder {
  justify-content: flex-end;
}
[data-tab-alignment="right"] .addui-Tabs-tabHolder .addui-Tabs-tab {
  flex: 0 0 auto;
}

/* ===== TAB STYLE: DEFAULT ===== */
/* (Already defined in base styles above) */

/* ===== TAB STYLE: PILLS ===== */
[data-tab-style="pills"] .addui-Tabs-tabHolder {
  gap: max(var(--pi-tab-gap), 8px);
  padding: 4px;
  background: rgba(0, 0, 0, 0.04);
  border-radius: calc(var(--pi-tab-radius) + 2px);
}

[data-tab-style="pills"] .addui-Tabs-tabHolder .addui-Tabs-tab {
  border: none;
  border-radius: max(var(--pi-tab-radius), 6px);
  padding: var(--pi-tab-padding-v) var(--pi-tab-padding-h);
  background: var(--pi-tab-bg);
  color: var(--pi-tab-text);
}

[data-tab-style="pills"] .addui-Tabs-tabHolder .addui-Tabs-tab:hover {
  background: var(--pi-tab-bg-hover);
}

[data-tab-style="pills"] .addui-Tabs-tabHolder .addui-Tabs-tab.addui-Tabs-active {
  background: var(--pi-tab-accent);
  color: #fff;
  border: none;
  padding: var(--pi-tab-padding-v) var(--pi-tab-padding-h);
  box-shadow: var(--pi-tab-shadow, 0 2px 4px rgba(0, 120, 212, 0.3));
}

[data-tab-style="pills"] .addui-Tabs-tabHolder .addui-Tabs-tab.addui-Tabs-active:hover {
  filter: brightness(0.9);
  color: #fff;
}

/* ===== TAB STYLE: UNDERLINE ===== */
[data-tab-style="underline"] .addui-Tabs-tabHolder {
  border-bottom: 1px solid var(--pi-tab-separator-color, rgba(0, 0, 0, 0.08));
  border-bottom-style: var(--pi-tab-separator-display, solid);
  gap: var(--pi-tab-gap);
}

[data-tab-style="underline"] .addui-Tabs-tabHolder .addui-Tabs-tab {
  border: none;
  border-bottom: var(--pi-tab-indicator-width) solid transparent;
  padding: var(--pi-tab-padding-v) var(--pi-tab-padding-h);
  background: var(--pi-tab-bg);
  color: var(--pi-tab-text);
  margin-bottom: -1px;
  border-radius: var(--pi-tab-radius) var(--pi-tab-radius) 0 0;
}

[data-tab-style="underline"] .addui-Tabs-tabHolder .addui-Tabs-tab:hover {
  color: rgba(0, 0, 0, 0.87);
  background: var(--pi-tab-bg-hover);
  border-bottom-color: rgba(0, 0, 0, 0.2);
}

[data-tab-style="underline"] .addui-Tabs-tabHolder .addui-Tabs-tab.addui-Tabs-active {
  border-bottom: var(--pi-tab-indicator-width) solid var(--pi-tab-indicator-color);
  border-bottom-style: var(--pi-tab-indicator-display, solid);
  color: var(--pi-tab-text-active);
  padding: var(--pi-tab-padding-v) var(--pi-tab-padding-h);
  background: var(--pi-tab-bg-active);
  box-shadow: var(--pi-tab-shadow);
}

/* ===== TAB STYLE: BOXED ===== */
[data-tab-style="boxed"] .addui-Tabs-tabHolder {
  gap: max(var(--pi-tab-gap), 4px);
  border-bottom: 1px solid var(--pi-tab-separator-color, rgba(0, 0, 0, 0.12));
  border-bottom-style: var(--pi-tab-separator-display, solid);
}

[data-tab-style="boxed"] .addui-Tabs-tabHolder .addui-Tabs-tab {
  border: 1px solid rgba(0, 0, 0, 0.12);
  border-bottom: none;
  border-radius: max(var(--pi-tab-radius), 8px) max(var(--pi-tab-radius), 8px) 0 0;
  padding: var(--pi-tab-padding-v) var(--pi-tab-padding-h);
  background: var(--pi-tab-bg, rgba(0, 0, 0, 0.02));
  color: var(--pi-tab-text);
  margin-bottom: -1px;
}

[data-tab-style="boxed"] .addui-Tabs-tabHolder .addui-Tabs-tab:hover {
  background: var(--pi-tab-bg-hover);
  color: rgba(0, 0, 0, 0.87);
}

[data-tab-style="boxed"] .addui-Tabs-tabHolder .addui-Tabs-tab.addui-Tabs-active {
  background: var(--pi-tab-bg-active, #fff);
  color: var(--pi-tab-text-active);
  border-color: rgba(0, 0, 0, 0.12);
  border-bottom: 1px solid var(--pi-tab-bg-active, #fff);
  padding: var(--pi-tab-padding-v) var(--pi-tab-padding-h);
  font-weight: calc(var(--pi-tab-font-weight) + 100);
  box-shadow: var(--pi-tab-shadow);
}

/* Ensure tab content containers fill full width */
.picanvas-tab-content {
  width: 100% !important;
  max-width: 100% !important;
  box-sizing: border-box;
}

/* Force the content wrapper itself to be full width */
.addui-Tabs .addui-Tabs-content {
  width: 100%;
}

.addui-Tabs .addui-Tabs-content.addui-Tabs-active {
  display: block;
  width: 100%;
}

/* ===== SECTION CONTENT - Preserve original SharePoint layout ===== */
/* When a section is moved into a tab, preserve its column structure */
.picanvas-tab-content.picanvas-section-content {
  width: 100%;
}

/* The section container itself - make it a flex row */
.picanvas-tab-content.picanvas-section-content > div {
  display: flex !important;
  flex-direction: row !important;
  flex-wrap: wrap !important;
  width: 100% !important;
  margin: 0 !important;
  padding: 0 !important;
}

/* SharePoint Canvas Section - force flex row layout */
.picanvas-tab-content.picanvas-section-content .CanvasSection,
.picanvas-tab-content.picanvas-section-content [class*="CanvasSection"] {
  display: flex !important;
  flex-direction: row !important;
  flex-wrap: wrap !important;
  width: 100% !important;
}

/* SharePoint Columns - preserve their width percentages */
/* 2-column layout: each column should be ~50% */
.picanvas-tab-content.picanvas-section-content .CanvasSection-col,
.picanvas-tab-content.picanvas-section-content [class*="CanvasSection-col"] {
  flex: 0 0 auto !important;
  box-sizing: border-box !important;
}

/* SharePoint responsive column classes */
/* Full width on small screens */
.picanvas-tab-content.picanvas-section-content .CanvasSection-sm12 {
  width: 100% !important;
}

/* Large screen column widths - 2 column (50% each) */
@media (min-width: 640px) {
  .picanvas-tab-content.picanvas-section-content .CanvasSection-lg6 {
    width: 50% !important;
    flex: 0 0 50% !important;
  }

  /* 3 column layout (33% each) */
  .picanvas-tab-content.picanvas-section-content .CanvasSection-lg4 {
    width: 33.333% !important;
    flex: 0 0 33.333% !important;
  }

  /* 1/3 + 2/3 layout */
  .picanvas-tab-content.picanvas-section-content .CanvasSection-lg8 {
    width: 66.666% !important;
    flex: 0 0 66.666% !important;
  }

  /* Full width column */
  .picanvas-tab-content.picanvas-section-content .CanvasSection-lg12 {
    width: 100% !important;
    flex: 0 0 100% !important;
  }
}

/* Images in sections should fit within their column */
.picanvas-tab-content.picanvas-section-content img {
  max-width: 100%;
  width: auto;
  height: auto;
}

/* Webparts inside section columns */
.picanvas-tab-content.picanvas-section-content .ControlZone,
.picanvas-tab-content.picanvas-section-content [class*="ControlZone"] {
  width: 100% !important;
  max-width: 100% !important;
}

/* ===== INDIVIDUAL WEBPART CONTENT - Full width ===== */
/* Individual webparts (not from sections) should fill full width */
.picanvas-tab-content.picanvas-single-webpart > div,
.picanvas-tab-content.picanvas-single-webpart > div > div,
.picanvas-tab-content.picanvas-single-webpart > div > div > div {
  width: 100% !important;
  max-width: 100% !important;
  box-sizing: border-box;
}

/* Override SharePoint container restrictions for individual webparts only */
.picanvas-tab-content.picanvas-single-webpart [data-automation-id="CanvasControl"],
.picanvas-tab-content.picanvas-single-webpart [class*="ControlZone"],
.picanvas-tab-content.picanvas-single-webpart [class*="webPartContainer"],
.picanvas-tab-content.picanvas-single-webpart [class*="controlZone"],
.picanvas-tab-content.picanvas-single-webpart [class*="WebPart"],
.picanvas-tab-content.picanvas-single-webpart [class*="webpart"] {
  width: 100% !important;
  max-width: 100% !important;
  box-sizing: border-box;
}

/* Force images inside individual webpart tabs to fill full width */
.picanvas-tab-content.picanvas-single-webpart img {
  width: 100% !important;
  max-width: 100% !important;
  height: auto !important;
  object-fit: cover;
}

/* Target SharePoint image webpart containers for individual webparts */
.picanvas-tab-content.picanvas-single-webpart [data-automation-id="imageWebPart"],
.picanvas-tab-content.picanvas-single-webpart [class*="imageWebPart"],
.picanvas-tab-content.picanvas-single-webpart [class*="ImageWebPart"],
.picanvas-tab-content.picanvas-single-webpart figure,
.picanvas-tab-content.picanvas-single-webpart picture {
  width: 100% !important;
  max-width: 100% !important;
}

/* Remove any margin/padding that creates whitespace for individual webparts */
.picanvas-tab-content.picanvas-single-webpart [class*="image"] {
  margin: 0 !important;
  padding: 0 !important;
  width: 100% !important;
}

/* ===== HERO/BANNER WEB PART FIXES ===== */
/* SharePoint Hero web parts use background-image on container divs.
   These layouts (overlap, image and title, color block, fade) need special handling
   to preserve their background images and height when inside PiCanvas tabs. */

/* Preserve Hero web part background images and layout */
.picanvas-tab-content [data-automation-id="HeroWebPart"],
.picanvas-tab-content [data-automation-id="heroWebPart"],
.picanvas-tab-content [class*="heroWebPart"],
.picanvas-tab-content [class*="HeroWebPart"],
.picanvas-tab-content .picanvas-hero-fixed {
  width: 100% !important;
  max-width: 100% !important;
  min-width: 100% !important;
  min-height: 300px; /* Ensure container has height for background-image */
  position: relative;
  display: block !important;
}

/* CRITICAL: Force ALL nested elements within Hero to fill full width */
.picanvas-tab-content [data-automation-id="HeroWebPart"] *,
.picanvas-tab-content [class*="heroWebPart"] *,
.picanvas-tab-content [class*="HeroWebPart"] *,
.picanvas-tab-content .picanvas-hero-fixed * {
  max-width: 100% !important;
  box-sizing: border-box !important;
}

/* All divs within Hero need explicit width reset */
.picanvas-tab-content [data-automation-id="HeroWebPart"] div,
.picanvas-tab-content [class*="heroWebPart"] div,
.picanvas-tab-content [class*="HeroWebPart"] div,
.picanvas-tab-content .picanvas-hero-fixed div {
  width: 100% !important;
  max-width: 100% !important;
  min-width: 0 !important;
  flex: 1 1 100% !important;
  flex-basis: 100% !important;
}

/* Hero layout containers that use background-image */
.picanvas-tab-content [data-automation-id="HeroWebPart"] [class*="heroLayout"],
.picanvas-tab-content [data-automation-id="HeroWebPart"] [class*="HeroLayout"],
.picanvas-tab-content [data-automation-id="HeroWebPart"] > div,
.picanvas-tab-content [class*="heroWebPart"] [class*="heroLayout"],
.picanvas-tab-content [class*="heroWebPart"] > div {
  background-size: cover !important;
  background-position: center !important;
  background-repeat: no-repeat !important;
  min-height: inherit;
  position: relative;
  width: 100% !important;
}

/* Preserve background-image on all child divs that might have it */
.picanvas-tab-content [data-automation-id="HeroWebPart"] [style*="background-image"],
.picanvas-tab-content [class*="heroWebPart"] [style*="background-image"],
.picanvas-tab-content [class*="HeroWebPart"] [style*="background-image"] {
  background-size: cover !important;
  background-position: center !important;
  background-repeat: no-repeat !important;
  min-height: 300px;
}

/* Hero content overlay - ensure proper positioning */
.picanvas-tab-content [data-automation-id="HeroWebPart"] [class*="heroContent"],
.picanvas-tab-content [data-automation-id="HeroWebPart"] [class*="HeroContent"],
.picanvas-tab-content [class*="heroWebPart"] [class*="heroContent"] {
  position: relative;
  z-index: 1;
}

/* Fix for overlap, fade, color block layouts that use absolute positioning */
.picanvas-tab-content [data-automation-id="HeroWebPart"] [class*="imageContainer"],
.picanvas-tab-content [data-automation-id="HeroWebPart"] [class*="backgroundImage"],
.picanvas-tab-content [class*="heroWebPart"] [class*="imageContainer"],
.picanvas-tab-content [class*="heroWebPart"] [class*="backgroundImage"] {
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  width: 100% !important;
  height: 100% !important;
  background-size: cover !important;
  background-position: center !important;
}

/* Banner web part specific fixes */
/* SharePoint Banner webpart uses deeply nested flex containers with calculated widths.
   When moved into PiCanvas tabs, these width calculations become stale and must be 
   aggressively overridden to ensure the banner fills 100% of the tab content area.
   
   Banner configurations handled:
   1. "Image and heading" - background image with text overlay
   2. "Heading only" - just text, colored background  
   3. "Color block" - solid color with text
   4. "Fade" - image fades into page background
   5. "Overlap" - image with overlapping text box
*/

/* Base Banner container - must fill full width ONLY when NOT in contained mode */
/* Use :not([data-fullwidth-banner="false"]) on parent to exclude contained banners */
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="BannerWebPart"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) .picanvas-banner-fixed {
  width: 100% !important;
  max-width: 100% !important;
  min-width: 100% !important;
  min-height: 200px;
  position: relative;
  display: block !important;
}

/* CRITICAL: Force ALL nested elements within Banner to fill full width - ONLY in full-width mode */
/* The JavaScript clears inline styles, CSS ensures they stay full width */
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] *,
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] *,
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="BannerWebPart"] *,
.picanvas-tab-content:not([data-fullwidth-banner="false"]) .picanvas-banner-fixed * {
  max-width: 100% !important;
  box-sizing: border-box !important;
}

/* All divs within Banner need explicit width reset - ONLY in full-width mode */
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] div,
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] div,
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="BannerWebPart"] div,
.picanvas-tab-content:not([data-fullwidth-banner="false"]) .picanvas-banner-fixed div {
  width: 100% !important;
  max-width: 100% !important;
  min-width: 0 !important; /* Allow flex items to shrink */
  flex: 1 1 100% !important;
  flex-basis: 100% !important;
}

/* Background images must cover full container - ONLY in full-width mode */
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] [style*="background-image"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] [style*="background-image"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) .picanvas-banner-fixed [style*="background-image"] {
  background-size: cover !important;
  background-position: center !important;
  background-repeat: no-repeat !important;
  min-height: inherit;
  width: 100% !important;
}

/* Banner layout containers - handle all configuration types - ONLY in full-width mode */
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] [class*="root"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] [class*="container"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] [class*="wrapper"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] [class*="content"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] [class*="layout"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] [class*="Layout"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] [class*="image"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] [class*="Image"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] [class*="banner"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] [class*="Banner"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] [class*="heading"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] [class*="Heading"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] [class*="text"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] [class*="Text"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] [class*="root"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] [class*="container"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] [class*="wrapper"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] [class*="content"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] [class*="layout"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] [class*="Layout"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] [class*="image"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] [class*="Image"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] [class*="banner"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] [class*="Banner"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] [class*="heading"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] [class*="Heading"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] [class*="text"],
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] [class*="Text"] {
  width: 100% !important;
  max-width: 100% !important;
  flex: 1 1 100% !important;
  flex-basis: 100% !important;
}

/* Fix Banner picture/img elements to fill container - ONLY in full-width mode */
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] picture,
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [data-automation-id="BannerWebPart"] img,
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] picture,
.picanvas-tab-content:not([data-fullwidth-banner="false"]) [class*="bannerWebPart"] img,
.picanvas-tab-content:not([data-fullwidth-banner="false"]) .picanvas-banner-fixed picture,
.picanvas-tab-content:not([data-fullwidth-banner="false"]) .picanvas-banner-fixed img {
  width: 100% !important;
  max-width: 100% !important;
  height: auto !important;
  object-fit: cover !important;
  display: block !important;
}

/* Special handling for "Overlap" and "Color block" layouts */
/* These have a text container that floats over the image */
.picanvas-tab-content [data-automation-id="BannerWebPart"] [class*="overlay"],
.picanvas-tab-content [data-automation-id="BannerWebPart"] [class*="Overlay"],
.picanvas-tab-content [data-automation-id="BannerWebPart"] [class*="textContainer"],
.picanvas-tab-content [data-automation-id="BannerWebPart"] [class*="TextContainer"],
.picanvas-tab-content [class*="bannerWebPart"] [class*="overlay"],
.picanvas-tab-content [class*="bannerWebPart"] [class*="Overlay"],
.picanvas-tab-content [class*="bannerWebPart"] [class*="textContainer"],
.picanvas-tab-content [class*="bannerWebPart"] [class*="TextContainer"] {
  /* These are okay to have auto width - they're text overlays */
  width: auto !important;
  max-width: 100% !important;
  flex: 0 1 auto !important;
}

/* Ensure CTA buttons don't stretch full width */
.picanvas-tab-content [data-automation-id="BannerWebPart"] a[class*="button"],
.picanvas-tab-content [data-automation-id="BannerWebPart"] button,
.picanvas-tab-content [data-automation-id="BannerWebPart"] [class*="cta"],
.picanvas-tab-content [data-automation-id="BannerWebPart"] [class*="CTA"],
.picanvas-tab-content [class*="bannerWebPart"] a[class*="button"],
.picanvas-tab-content [class*="bannerWebPart"] button,
.picanvas-tab-content [class*="bannerWebPart"] [class*="cta"],
.picanvas-tab-content [class*="bannerWebPart"] [class*="CTA"] {
  width: auto !important;
  flex: 0 0 auto !important;
}

/* Ensure the first child container in hero/banner maintains height */
.picanvas-tab-content.picanvas-single-webpart [data-automation-id="HeroWebPart"] > div:first-child,
.picanvas-tab-content.picanvas-single-webpart [class*="heroWebPart"] > div:first-child {
  min-height: 300px;
  width: 100% !important;
}

/* Fix for Hero web part images that use <img> tags instead of background-image */
.picanvas-tab-content [data-automation-id="HeroWebPart"] img,
.picanvas-tab-content [class*="heroWebPart"] img,
.picanvas-tab-content [class*="HeroWebPart"] img {
  width: 100% !important;
  height: 100% !important;
  object-fit: cover !important;
  object-position: center !important;
}

/* SharePoint uses cB (Canvas Background) class patterns for hero backgrounds */
.picanvas-tab-content [class*="cB"],
.picanvas-tab-content [class*="canvasBackground"] {
  min-height: 300px;
  background-size: cover !important;
  background-position: center !important;
}

/* Handle picture elements used in modern SharePoint */
.picanvas-tab-content [data-automation-id="HeroWebPart"] picture,
.picanvas-tab-content [class*="heroWebPart"] picture {
  display: block;
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
}

.picanvas-tab-content [data-automation-id="HeroWebPart"] picture img,
.picanvas-tab-content [class*="heroWebPart"] picture img {
  position: absolute;
  top: 0;
  left: 0;
  width: 100% !important;
  height: 100% !important;
  object-fit: cover !important;
}

/* Force visibility on img elements with loading="lazy" attribute */
.picanvas-tab-content img[loading="lazy"] {
  content-visibility: auto;
}

/* Handle Hero layouts with flex containers */
.picanvas-tab-content [data-automation-id="HeroWebPart"] [class*="layout"],
.picanvas-tab-content [class*="heroWebPart"] [class*="layout"] {
  display: flex !important;
  flex-direction: column;
  min-height: inherit;
  position: relative;
}

/* Ensure image wrapper has proper dimensions */
.picanvas-tab-content [data-automation-id="HeroWebPart"] [class*="imageWrapper"],
.picanvas-tab-content [data-automation-id="HeroWebPart"] [class*="ImageWrapper"],
.picanvas-tab-content [class*="heroWebPart"] [class*="imageWrapper"] {
  width: 100% !important;
  height: 100% !important;
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  overflow: hidden;
}

/* Highlight styles for webpart/section selection in property pane */
.picanvas-highlight {
  position: relative;
  outline: 3px solid #0078d4 !important;
  outline-offset: 2px;
  box-shadow: 0 0 0 6px rgba(0, 120, 212, 0.3) !important;
  animation: picanvas-pulse 1.5s ease-in-out infinite;
  z-index: 100;
}

.picanvas-highlight::before {
  content: '';
  position: absolute;
  top: -8px;
  left: -8px;
  right: -8px;
  bottom: -8px;
  border: 2px dashed #0078d4;
  border-radius: 4px;
  pointer-events: none;
  animation: picanvas-dash 0.5s linear infinite;
}

@keyframes picanvas-pulse {
  0%, 100% {
    box-shadow: 0 0 0 6px rgba(0, 120, 212, 0.3);
  }
  50% {
    box-shadow: 0 0 0 10px rgba(0, 120, 212, 0.15);
  }
}

@keyframes picanvas-dash {
  to {
    stroke-dashoffset: -10px;
  }
}

/* Section highlight - slightly different style */
.picanvas-section-highlight {
  position: relative;
  background-color: rgba(0, 120, 212, 0.08) !important;
  outline: 3px solid #0078d4 !important;
  outline-offset: 4px;
  animation: picanvas-pulse 1.5s ease-in-out infinite;
}

/* ===== TAB DIVIDERS ===== */
/* Horizontal mode - vertical divider line after tab */
[data-tab-orientation="horizontal"] .addui-Tabs-tabHolder .addui-Tabs-tab[data-divider-after="true"]::after {
  content: '';
  position: absolute;
  right: -1px;
  top: 20%;
  height: 60%;
  width: 2px;
  background: linear-gradient(to bottom, transparent, var(--pi-tab-accent, #0078d4), transparent);
  opacity: 0.5;
  z-index: 10;
}

/* Ensure tab has relative positioning for the divider */
.addui-Tabs-tabHolder .addui-Tabs-tab[data-divider-after="true"] {
  position: relative;
}

/* Add some spacing after divider */
[data-tab-orientation="horizontal"] .addui-Tabs-tabHolder .addui-Tabs-tab[data-divider-after="true"] {
  margin-right: 8px;
}

/* Vertical mode - horizontal divider line after tab */
[data-tab-orientation="vertical"] .addui-Tabs-tabHolder .addui-Tabs-tab[data-divider-after="true"]::after {
  content: '';
  position: absolute;
  left: 10%;
  bottom: -1px;
  width: 80%;
  height: 2px;
  background: linear-gradient(to right, transparent, var(--pi-tab-accent, #0078d4), transparent);
  opacity: 0.5;
  z-index: 10;
}

/* Add spacing after divider in vertical mode */
[data-tab-orientation="vertical"] .addui-Tabs-tabHolder .addui-Tabs-tab[data-divider-after="true"] {
  margin-bottom: 8px;
}

/* ===== VERTICAL TAB LAYOUT ===== */
/* Main container - flex row layout */
[data-tab-orientation="vertical"].addui-Tabs {
  display: flex !important;
  flex-direction: row !important;
  width: 100%;
  min-height: 300px;
}

/* Tabs on right side - reverse the flex direction */
[data-tab-orientation="vertical"][data-vertical-position="right"].addui-Tabs {
  flex-direction: row-reverse !important;
}

/* Vertical tab holder - column layout */
[data-tab-orientation="vertical"] .addui-Tabs-tabHolder {
  flex-direction: column !important;
  width: var(--pi-vertical-tab-width, 200px) !important;
  min-width: var(--pi-vertical-tab-width, 200px) !important;
  max-width: var(--pi-vertical-tab-width, 200px) !important;
  flex-shrink: 0 !important;
  gap: 0 !important;
  border-bottom: none !important;
  border-right: 1px solid var(--pi-tab-separator-color, rgba(0, 0, 0, 0.12));
  border-right-style: var(--pi-tab-separator-display, solid);
  height: auto;
  align-self: stretch;
}

/* Right side tabs - border on left instead of right */
[data-tab-orientation="vertical"][data-vertical-position="right"] .addui-Tabs-tabHolder {
  border-right: none !important;
  border-left: 1px solid var(--pi-tab-separator-color, rgba(0, 0, 0, 0.12));
  border-left-style: var(--pi-tab-separator-display, solid);
}

/* Individual vertical tabs */
[data-tab-orientation="vertical"] .addui-Tabs-tabHolder .addui-Tabs-tab {
  flex: 0 0 auto !important;
  width: 100% !important;
  text-align: left !important;
  border-bottom: none !important;
  border-right: 3px solid transparent;
  border-radius: 0 !important;
  padding: var(--pi-tab-padding-v, 12px) var(--pi-tab-padding-h, 16px);
}

/* Right side - indicator on left */
[data-tab-orientation="vertical"][data-vertical-position="right"] .addui-Tabs-tabHolder .addui-Tabs-tab {
  text-align: right !important;
  border-right: none !important;
  border-left: 3px solid transparent;
}

/* Active vertical tab */
[data-tab-orientation="vertical"] .addui-Tabs-tabHolder .addui-Tabs-tab.addui-Tabs-active {
  border-bottom: none !important;
  border-right-color: var(--pi-tab-indicator-color, var(--pi-tab-accent, #0078d4)) !important;
  border-right-width: var(--pi-tab-indicator-width, 3px) !important;
  border-right-style: var(--pi-tab-indicator-display, solid) !important;
  padding-bottom: var(--pi-tab-padding-v, 12px) !important;
  background: var(--pi-tab-bg-active, rgba(0, 120, 212, 0.08)) !important;
}

/* Right side active indicator */
[data-tab-orientation="vertical"][data-vertical-position="right"] .addui-Tabs-tabHolder .addui-Tabs-tab.addui-Tabs-active {
  border-right-color: transparent !important;
  border-left-color: var(--pi-tab-indicator-color, var(--pi-tab-accent, #0078d4)) !important;
  border-left-width: var(--pi-tab-indicator-width, 3px) !important;
  border-left-style: var(--pi-tab-indicator-display, solid) !important;
}

/* Vertical tab content area */
[data-tab-orientation="vertical"] .addui-Tabs-content {
  flex: 1 !important;
  min-width: 0 !important;
  width: auto !important;
  padding: 16px;
  overflow: visible;
}

/* ===== VERTICAL MODE STYLE ADJUSTMENTS ===== */

/* Pills style in vertical mode */
[data-tab-orientation="vertical"][data-tab-style="pills"] .addui-Tabs-tabHolder .addui-Tabs-tab {
  margin: 4px 8px;
  width: calc(100% - 16px) !important;
  border-radius: var(--pi-tab-radius, 6px) !important;
  border-right: none !important;
  border-left: none !important;
}

[data-tab-orientation="vertical"][data-tab-style="pills"] .addui-Tabs-tabHolder .addui-Tabs-tab.addui-Tabs-active {
  border-right: none !important;
  border-left: none !important;
}

/* Boxed style in vertical mode */
[data-tab-orientation="vertical"][data-tab-style="boxed"] .addui-Tabs-tabHolder .addui-Tabs-tab {
  margin: 4px 8px;
  width: calc(100% - 16px) !important;
  border: 1px solid rgba(0, 0, 0, 0.12) !important;
  border-radius: var(--pi-tab-radius, 8px) !important;
}

[data-tab-orientation="vertical"][data-tab-style="boxed"] .addui-Tabs-tabHolder .addui-Tabs-tab.addui-Tabs-active {
  border-color: var(--pi-tab-indicator-color, var(--pi-tab-accent, #0078d4)) !important;
  border-width: 2px !important;
  border-style: var(--pi-tab-indicator-display, solid) !important;
}

/* Underline style in vertical mode - just left/right border */
[data-tab-orientation="vertical"][data-tab-style="underline"] .addui-Tabs-tabHolder .addui-Tabs-tab {
  border-right: 2px solid transparent !important;
}

[data-tab-orientation="vertical"][data-tab-style="underline"] .addui-Tabs-tabHolder .addui-Tabs-tab.addui-Tabs-active {
  border-right-color: var(--pi-tab-indicator-color, var(--pi-tab-accent, #0078d4)) !important;
  border-right-style: var(--pi-tab-indicator-display, solid) !important;
}

[data-tab-orientation="vertical"][data-vertical-position="right"][data-tab-style="underline"] .addui-Tabs-tabHolder .addui-Tabs-tab {
  border-right: none !important;
  border-left: 2px solid transparent !important;
}

[data-tab-orientation="vertical"][data-vertical-position="right"][data-tab-style="underline"] .addui-Tabs-tabHolder .addui-Tabs-tab.addui-Tabs-active {
  border-left-color: var(--pi-tab-indicator-color, var(--pi-tab-accent, #0078d4)) !important;
  border-left-style: var(--pi-tab-indicator-display, solid) !important;
}

/* ===== VERTICAL MODE CONTENT SIZING ===== */
/* Ensure content in vertical mode fills properly */
[data-tab-orientation="vertical"] .addui-Tabs-content.addui-Tabs-active {
  display: flex !important;
  flex-direction: column;
}

[data-tab-orientation="vertical"] .picanvas-tab-content {
  width: 100% !important;
  max-width: 100% !important;
}

/* Sections in vertical mode */
[data-tab-orientation="vertical"] .picanvas-tab-content.picanvas-section-content {
  width: 100% !important;
}

[data-tab-orientation="vertical"] .picanvas-tab-content.picanvas-section-content > div {
  width: 100% !important;
}

/* Individual webparts in vertical mode - full width */
[data-tab-orientation="vertical"] .picanvas-tab-content.picanvas-single-webpart {
  width: 100% !important;
}

[data-tab-orientation="vertical"] .picanvas-tab-content.picanvas-single-webpart img {
  width: 100% !important;
  max-width: 100% !important;
  height: auto !important;
}

/* Web part labels in vertical tabs */
[data-tab-orientation="vertical"] .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab {
  justify-content: flex-start !important;
}

[data-tab-orientation="vertical"][data-vertical-position="right"] .addui-Tabs-tabHolder .addui-Tabs-tab.webpart-label-tab {
  justify-content: flex-end !important;
}

/* ===== DARK MODE FOR VERTICAL TABS ===== */
[data-tab-orientation="vertical"] .addui-Tabs-tabHolder {
  border-color: rgba(255, 255, 255, 0.12);
}

/* Dark mode detection via parent class or data attribute */
.darkMode [data-tab-orientation="vertical"] .addui-Tabs-tabHolder,
[data-theme="dark"] [data-tab-orientation="vertical"] .addui-Tabs-tabHolder {
  border-color: rgba(255, 255, 255, 0.12);
}

/* ===== RESPONSIVE VERTICAL TABS ===== */
/* On small screens, stack vertically (tabs on top) */
@media (max-width: 768px) {
  [data-tab-orientation="vertical"].addui-Tabs {
    flex-direction: column !important;
  }

  [data-tab-orientation="vertical"][data-vertical-position="right"].addui-Tabs {
    flex-direction: column !important;
  }

  [data-tab-orientation="vertical"] .addui-Tabs-tabHolder {
    flex-direction: row !important;
    width: 100% !important;
    min-width: 100% !important;
    max-width: 100% !important;
    border-right: none !important;
    border-left: none !important;
    border-bottom: 1px solid rgba(0, 0, 0, 0.12) !important;
    overflow-x: auto;
  }

  [data-tab-orientation="vertical"] .addui-Tabs-tabHolder .addui-Tabs-tab {
    flex: 0 0 auto !important;
    width: auto !important;
    border-right: none !important;
    border-left: none !important;
    border-bottom: 3px solid transparent !important;
  }

  [data-tab-orientation="vertical"] .addui-Tabs-tabHolder .addui-Tabs-tab.addui-Tabs-active {
    border-right: none !important;
    border-left: none !important;
    border-bottom-color: var(--pi-tab-accent, #0078d4) !important;
  }

  [data-tab-orientation="vertical"] .addui-Tabs-content {
    padding: 12px 0;
  }
}

/* ===== PERMISSION PLACEHOLDER TABS ===== */

/* Placeholder tab styling - disabled appearance */
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab[data-placeholder="true"] {
  opacity: 0.5;
  cursor: not-allowed;
  pointer-events: none;
  position: relative;
}

.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab[data-placeholder="true"]::after {
  content: attr(data-placeholder-text);
  position: absolute;
  bottom: -20px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 10px;
  color: var(--pi-tab-text);
  opacity: 0.7;
  white-space: nowrap;
  display: none;
}

/* Show tooltip on hover for placeholder tabs */
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab[data-placeholder="true"]:hover::after {
  display: block;
}

/* Placeholder content area styling */
.picanvas-placeholder-content {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 150px;
  background: linear-gradient(135deg, rgba(0,0,0,0.02) 0%, rgba(0,0,0,0.05) 100%);
  border-radius: 8px;
  margin: 16px 0;
}

.placeholder-restricted-message {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  color: var(--pi-tab-text, rgba(0, 0, 0, 0.6));
  opacity: 0.7;
}

.placeholder-restricted-message .placeholder-icon {
  font-size: 32px;
}

.placeholder-restricted-message .placeholder-text {
  font-size: 14px;
  font-weight: 500;
}

/* Dark mode support for placeholders */
.addui-Tabs[data-theme="dark"] .picanvas-placeholder-content {
  background: linear-gradient(135deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.05) 100%);
}

.addui-Tabs[data-theme="dark"] .placeholder-restricted-message {
  color: rgba(255, 255, 255, 0.6);
}

/* ===== WCAG 2.2 ACCESSIBILITY STYLES ===== */

/* WCAG 2.4.7 - Visible focus indicator */
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab:focus {
  outline: 3px solid var(--pi-tab-accent, #0078d4);
  outline-offset: 2px;
  z-index: 10;
}

/* Remove focus outline for mouse users */
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab:focus:not(:focus-visible) {
  outline: none;
}

/* Enhanced focus for keyboard users */
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab:focus-visible {
  outline: 3px solid var(--pi-tab-accent, #0078d4);
  outline-offset: 2px;
  box-shadow: 0 0 0 6px rgba(0, 120, 212, 0.2);
  z-index: 10;
}

/* Focus indicator for tab panels (for keyboard navigation into content) */
.addui-Tabs .addui-Tabs-content[role="tabpanel"]:focus {
  outline: 2px solid var(--pi-tab-accent, #0078d4);
  outline-offset: 2px;
}

.addui-Tabs .addui-Tabs-content[role="tabpanel"]:focus:not(:focus-visible) {
  outline: none;
}

.addui-Tabs .addui-Tabs-content[role="tabpanel"]:focus-visible {
  outline: 2px solid var(--pi-tab-accent, #0078d4);
  outline-offset: 2px;
}

/* WCAG 2.5.5 - Minimum touch target size (44x44px recommendation) */
.addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab {
  min-height: 44px;
  min-width: 44px;
}

/* ===== HIGH CONTRAST MODE SUPPORT ===== */
@media (forced-colors: active) {
  .addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab {
    border: 1px solid CanvasText;
  }

  .addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab:focus,
  .addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab:focus-visible {
    outline: 3px solid Highlight;
    outline-offset: 2px;
  }

  .addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab.addui-Tabs-active {
    border-color: Highlight;
    background: Highlight;
    color: HighlightText;
    forced-color-adjust: none;
  }

  .addui-Tabs .addui-Tabs-tabHolder .addui-Tabs-tab[data-placeholder="true"] {
    border-style: dashed;
    opacity: 0.7;
  }

  /* High contrast focus for content panels */
  .addui-Tabs .addui-Tabs-content[role="tabpanel"]:focus,
  .addui-Tabs .addui-Tabs-content[role="tabpanel"]:focus-visible {
    outline: 3px solid Highlight;
  }
}

/* ===== REDUCED MOTION SUPPORT ===== */
/* Respect user's motion preferences (WCAG 2.3.3) */
@media (prefers-reduced-motion: reduce) {
  .addui-Tabs,
  .addui-Tabs .addui-Tabs-tab,
  .addui-Tabs .addui-Tabs-content,
  .addui-Tabs [data-addui="tabs"],
  .addui-Tabs [data-addui="tabs"] * {
    transition: none !important;
    animation: none !important;
  }

  /* Disable highlight animations */
  .picanvas-highlight,
  .picanvas-section-highlight {
    animation: none !important;
  }

  .picanvas-highlight::before {
    animation: none !important;
  }
}

/* Manual transition disable via class (added by JS) */
.addui-Tabs.picanvas-no-transitions,
.addui-Tabs.picanvas-no-transitions .addui-Tabs-tab,
.addui-Tabs.picanvas-no-transitions .addui-Tabs-content {
  transition: none !important;
  animation: none !important;
}

/* ===== CUSTOM CONTENT STYLES ===== */

/* Base custom content container */
.picanvas-tab-content.picanvas-custom-content {
  padding: 16px;
  width: 100%;
  box-sizing: border-box;
}

/* Markdown content styling */
.picanvas-tab-content.markdown-content {
  line-height: 1.6;
  font-size: 15px;
  color: var(--pi-tab-text, rgba(0, 0, 0, 0.87));
}

.picanvas-tab-content.markdown-content h1,
.picanvas-tab-content.markdown-content h2,
.picanvas-tab-content.markdown-content h3,
.picanvas-tab-content.markdown-content h4,
.picanvas-tab-content.markdown-content h5,
.picanvas-tab-content.markdown-content h6 {
  margin-top: 1.5em;
  margin-bottom: 0.5em;
  font-weight: 600;
  line-height: 1.25;
}

.picanvas-tab-content.markdown-content h1 { font-size: 2em; }
.picanvas-tab-content.markdown-content h2 { font-size: 1.5em; }
.picanvas-tab-content.markdown-content h3 { font-size: 1.25em; }
.picanvas-tab-content.markdown-content h4 { font-size: 1em; }

.picanvas-tab-content.markdown-content p {
  margin: 0 0 1em 0;
}

.picanvas-tab-content.markdown-content a {
  color: var(--pi-tab-accent, #0078d4);
  text-decoration: none;
}

.picanvas-tab-content.markdown-content a:hover {
  text-decoration: underline;
}

.picanvas-tab-content.markdown-content code {
  background: rgba(0, 0, 0, 0.06);
  padding: 2px 6px;
  border-radius: 4px;
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
  font-size: 0.9em;
}

.picanvas-tab-content.markdown-content pre {
  background: rgba(0, 0, 0, 0.06);
  padding: 16px;
  border-radius: 8px;
  overflow-x: auto;
  margin: 1em 0;
}

.picanvas-tab-content.markdown-content pre code {
  background: none;
  padding: 0;
  font-size: 0.85em;
}

.picanvas-tab-content.markdown-content blockquote {
  border-left: 4px solid var(--pi-tab-accent, #0078d4);
  margin: 1em 0;
  padding: 0.5em 0 0.5em 1em;
  color: rgba(0, 0, 0, 0.6);
  background: rgba(0, 0, 0, 0.02);
}

.picanvas-tab-content.markdown-content ul,
.picanvas-tab-content.markdown-content ol {
  margin: 0 0 1em 0;
  padding-left: 2em;
}

.picanvas-tab-content.markdown-content li {
  margin: 0.25em 0;
}

.picanvas-tab-content.markdown-content table {
  width: 100%;
  border-collapse: collapse;
  margin: 1em 0;
}

.picanvas-tab-content.markdown-content th,
.picanvas-tab-content.markdown-content td {
  border: 1px solid rgba(0, 0, 0, 0.12);
  padding: 8px 12px;
  text-align: left;
}

.picanvas-tab-content.markdown-content th {
  background: rgba(0, 0, 0, 0.04);
  font-weight: 600;
}

.picanvas-tab-content.markdown-content img {
  max-width: 100%;
  height: auto;
  border-radius: 4px;
}

.picanvas-tab-content.markdown-content hr {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.12);
  margin: 2em 0;
}

/* HTML content styling */
.picanvas-tab-content.html-content {
  line-height: 1.6;
}

/* Mermaid diagram container */
.picanvas-mermaid-container {
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 200px;
  width: 100%;
}

.picanvas-mermaid-container .mermaid {
  max-width: 100%;
  overflow-x: auto;
}

.picanvas-mermaid-container .mermaid svg {
  max-width: 100%;
  height: auto;
}

.picanvas-mermaid-container.picanvas-mermaid-rendered {
  min-height: auto;
}

/* Mermaid error styling */
.picanvas-mermaid-error {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  padding: 24px;
  background: rgba(255, 0, 0, 0.05);
  border: 1px solid rgba(255, 0, 0, 0.2);
  border-radius: 8px;
  color: #d32f2f;
  text-align: center;
}

.picanvas-mermaid-error .error-icon {
  font-size: 32px;
}

.picanvas-mermaid-error .error-text {
  font-weight: 500;
}

.picanvas-mermaid-error details {
  margin-top: 8px;
  text-align: left;
  width: 100%;
}

.picanvas-mermaid-error details summary {
  cursor: pointer;
  font-size: 12px;
  color: rgba(0, 0, 0, 0.6);
}

.picanvas-mermaid-error details pre {
  margin-top: 8px;
  padding: 12px;
  background: rgba(0, 0, 0, 0.04);
  border-radius: 4px;
  font-size: 11px;
  overflow-x: auto;
  white-space: pre-wrap;
  word-break: break-word;
}

/* Embed container */
.picanvas-embed-container {
  width: 100%;
  min-height: 200px;
  background: rgba(0, 0, 0, 0.02);
  border-radius: 8px;
  overflow: hidden;
}

.picanvas-embed-container iframe {
  display: block;
}

/* Embed blocked message */
.picanvas-embed-blocked {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 12px;
  padding: 32px;
  background: rgba(255, 152, 0, 0.08);
  border: 1px solid rgba(255, 152, 0, 0.3);
  border-radius: 8px;
  text-align: center;
  min-height: 150px;
}

.picanvas-embed-blocked .blocked-icon {
  font-size: 32px;
}

.picanvas-embed-blocked .blocked-text {
  font-weight: 500;
  color: rgba(0, 0, 0, 0.7);
}

.picanvas-embed-blocked details {
  margin-top: 8px;
  text-align: center;
}

.picanvas-embed-blocked details summary {
  cursor: pointer;
  font-size: 12px;
  color: rgba(0, 0, 0, 0.5);
}

.picanvas-embed-blocked details p {
  margin-top: 8px;
  font-size: 12px;
  color: rgba(0, 0, 0, 0.6);
}

/* Content render error */
.picanvas-render-error {
  padding: 16px;
  background: rgba(255, 0, 0, 0.05);
  border: 1px solid rgba(255, 0, 0, 0.2);
  border-radius: 8px;
  color: #d32f2f;
  font-weight: 500;
}

/* ===== DARK MODE FOR CUSTOM CONTENT ===== */
.addui-Tabs[data-theme="dark"] .picanvas-tab-content.markdown-content,
.darkMode .picanvas-tab-content.markdown-content {
  color: rgba(255, 255, 255, 0.87);
}

.addui-Tabs[data-theme="dark"] .picanvas-tab-content.markdown-content code,
.darkMode .picanvas-tab-content.markdown-content code {
  background: rgba(255, 255, 255, 0.1);
}

.addui-Tabs[data-theme="dark"] .picanvas-tab-content.markdown-content pre,
.darkMode .picanvas-tab-content.markdown-content pre {
  background: rgba(255, 255, 255, 0.08);
}

.addui-Tabs[data-theme="dark"] .picanvas-tab-content.markdown-content blockquote,
.darkMode .picanvas-tab-content.markdown-content blockquote {
  color: rgba(255, 255, 255, 0.6);
  background: rgba(255, 255, 255, 0.04);
}

.addui-Tabs[data-theme="dark"] .picanvas-tab-content.markdown-content th,
.darkMode .picanvas-tab-content.markdown-content th {
  background: rgba(255, 255, 255, 0.08);
}

.addui-Tabs[data-theme="dark"] .picanvas-tab-content.markdown-content th,
.addui-Tabs[data-theme="dark"] .picanvas-tab-content.markdown-content td,
.darkMode .picanvas-tab-content.markdown-content th,
.darkMode .picanvas-tab-content.markdown-content td {
  border-color: rgba(255, 255, 255, 0.12);
}

.addui-Tabs[data-theme="dark"] .picanvas-tab-content.markdown-content hr,
.darkMode .picanvas-tab-content.markdown-content hr {
  border-top-color: rgba(255, 255, 255, 0.12);
}

.addui-Tabs[data-theme="dark"] .picanvas-embed-container,
.darkMode .picanvas-embed-container {
  background: rgba(255, 255, 255, 0.04);
}

.addui-Tabs[data-theme="dark"] .picanvas-mermaid-error details pre,
.darkMode .picanvas-mermaid-error details pre {
  background: rgba(255, 255, 255, 0.08);
}

/* ===== CONTENT-ONLY MODE (Hidden Labels) ===== */
/* Hide entire tab bar when all tabs have hidden labels */
.addui-Tabs[data-content-only="true"] .addui-Tabs-tabHolder {
  display: none !important;
}

/* In content-only mode, show all content panels stacked */
.addui-Tabs[data-content-only="true"] .addui-Tabs-content .picanvas-tab-content {
  display: block !important;
  visibility: visible !important;
  opacity: 1 !important;
  position: relative !important;
  height: auto !important;
  overflow: visible !important;
}

/* Remove margin/padding from tabs container in content-only mode */
.addui-Tabs[data-content-only="true"] {
  padding: 0;
}

.addui-Tabs[data-content-only="true"] .addui-Tabs-content {
  margin-top: 0;
}

/* Individual hidden label tabs */
.addui-Tabs-tab.hidden-label-tab,
.addui-Tabs-tab[data-hidden-label="true"] {
  display: none !important;
}

/* ===== GLOBAL BANNER/HERO/PAGE TITLE FIXES ===== */
/* These fixes apply to ALL Banner, Hero, and PageTitle webparts on pages
   where PiCanvas is loaded, not just those inside tabs.

   The issue: SharePoint uses max-width constraints on section containers
   that prevent fullWidthImageLayout from actually being full width.

   Key selectors discovered:
   - CanvasZone-SectionContainer: Has max-width constraint (e.g. 1236px)
   - CanvasSection: Inherits the constrained width
   - CanvasControl: Further constrains
   - fullWidthImageLayout: The actual image container */

/* CRITICAL: Remove max-width constraint from section containers that have fullWidthImageLayout
   ONLY when the banner is NOT in contained mode (picanvas-contained-banner class) */
[data-automation-id="CanvasZone-SectionContainer"]:has([data-automation-id="fullWidthImageLayout"]:not(.picanvas-contained-banner)) {
  max-width: 100% !important;
  width: 100% !important;
}

[data-automation-id="CanvasSection"]:has([data-automation-id="fullWidthImageLayout"]:not(.picanvas-contained-banner)) {
  max-width: 100% !important;
  width: 100% !important;
}

[data-automation-id="CanvasControl"]:has([data-automation-id="fullWidthImageLayout"]:not(.picanvas-contained-banner)) {
  max-width: 100% !important;
  width: 100% !important;
}

/* ControlZone containers that hold banner/title webparts - ONLY when NOT in contained mode */
.ControlZone--control:has([data-automation-id="fullWidthImageLayout"]:not(.picanvas-contained-banner)),
.ControlZone:has([data-automation-id="fullWidthImageLayout"]:not(.picanvas-contained-banner)) {
  width: 100% !important;
  max-width: 100% !important;
}

/* PageTitle / Banner with fullWidthImageLayout - ONLY when NOT in contained mode */
[data-automation-id="fullWidthImageLayout"]:not(.picanvas-contained-banner) {
  width: 100% !important;
  max-width: 100% !important;
  min-width: 100% !important;
}

[data-automation-id="fullWidthImageLayout"]:not(.picanvas-contained-banner) > div,
[data-automation-id="fullWidthImageLayout"]:not(.picanvas-contained-banner) img {
  width: 100% !important;
  max-width: 100% !important;
}

/* CRITICAL: Lock banner height to prevent resize on scroll */
/* SharePoint's resize observers can recalculate image dimensions when scrolling,
   causing the banner to resize. Once the image is loaded, we lock the container height. */
[data-automation-id="fullWidthImageLayout"].picanvas-height-locked {
  overflow: hidden !important;
}

[data-automation-id="fullWidthImageLayout"].picanvas-height-locked img {
  object-fit: cover !important;
  height: 100% !important;
  min-height: inherit !important;
}

/* Gradient overlay box - ensure it covers full width (only in full-width mode) */
[data-automation-id="fullWidthImageLayout"]:not(.picanvas-contained-banner) [data-automation-id="gradientBox"] {
  width: 100% !important;
  max-width: 100% !important;
}

/* Force ALL parent containers of fullWidthImageLayout to be full width - ONLY when NOT contained */
div:has(> [data-automation-id="fullWidthImageLayout"]:not(.picanvas-contained-banner)),
div:has(> div > [data-automation-id="fullWidthImageLayout"]:not(.picanvas-contained-banner)),
div:has(> div > div > [data-automation-id="fullWidthImageLayout"]:not(.picanvas-contained-banner)),
div:has(> div > div > div > [data-automation-id="fullWidthImageLayout"]:not(.picanvas-contained-banner)),
div:has(> div > div > div > div > [data-automation-id="fullWidthImageLayout"]:not(.picanvas-contained-banner)) {
  width: 100% !important;
  max-width: 100% !important;
}

/* Global Banner width fix - ensures banners fill their container - ONLY when NOT contained */
[data-automation-id="BannerWebPart"]:not(.picanvas-contained-banner),
[class*="bannerWebPart"]:not(.picanvas-contained-banner),
[class*="BannerWebPart"]:not(.picanvas-contained-banner) {
  width: 100% !important;
  max-width: 100% !important;
}

/* Clear stale width calculations from Banner nested containers - ONLY when NOT contained */
[data-automation-id="BannerWebPart"]:not(.picanvas-contained-banner) > div,
[data-automation-id="BannerWebPart"]:not(.picanvas-contained-banner) > div > div,
[class*="bannerWebPart"]:not(.picanvas-contained-banner) > div,
[class*="bannerWebPart"]:not(.picanvas-contained-banner) > div > div {
  width: 100% !important;
  max-width: 100% !important;
  flex: 1 1 100% !important;
}

/* Ensure Banner background images cover full width - ONLY when NOT contained */
[data-automation-id="BannerWebPart"]:not(.picanvas-contained-banner) [style*="background-image"],
[class*="bannerWebPart"]:not(.picanvas-contained-banner) [style*="background-image"] {
  width: 100% !important;
  background-size: cover !important;
  background-position: center !important;
}

/* Global Hero width fix */
[data-automation-id="HeroWebPart"],
[class*="heroWebPart"],
[class*="HeroWebPart"] {
  width: 100% !important;
  max-width: 100% !important;
}

[data-automation-id="HeroWebPart"] > div,
[data-automation-id="HeroWebPart"] > div > div,
[class*="heroWebPart"] > div,
[class*="heroWebPart"] > div > div {
  width: 100% !important;
  max-width: 100% !important;
  flex: 1 1 100% !important;
}

/* ===== CONTAINED BANNER MODE ===== */
/* When Banner Layout is set to "Contained (with margins)",
   we constrain the banner to SharePoint's standard content width (1236px).

   PROBLEM SOLVED: When PiCanvas is in a full-width section with supportsFlexibleLayout,
   the tab content container expands to 100% viewport width. The previous scaling
   approach (transform: scale()) didn't work because:
   - scaleFactor = containerWidth / viewportWidth  1.0 when both are full-width
   - This resulted in barely visible 3% reduction instead of proper containment

   SOLUTION: Apply explicit max-width constraint matching SharePoint's standard
   contained section width, regardless of the parent container's actual width. */

/* Contained banner mode - constrain tab content to SharePoint's standard 1236px width */
.picanvas-tab-content[data-fullwidth-banner="false"] {
  display: flex !important;
  justify-content: center !important;
  align-items: flex-start !important;
  max-width: 1236px !important;
  margin-left: auto !important;
  margin-right: auto !important;
  overflow: hidden !important;
  position: relative !important; /* Create containing block for absolutely positioned children */
}

/* CRITICAL: Override SharePoint's viewport-width tricks in contained mode */
/* SharePoint banners use "width: 100vw; margin-left: calc(-50vw + 50%)" to escape containers */
/* We must force them to use 100% of their container instead */
.picanvas-contained-banner,
.picanvas-tab-content[data-fullwidth-banner="false"] [data-automation-id="fullWidthImageLayout"] {
  width: 100% !important;
  max-width: 100% !important;
  min-width: 0 !important;
  margin-left: 0 !important;
  margin-right: 0 !important;
  left: 0 !important;
  right: 0 !important;
  transform: none !important;
}

/* Force ALL nested elements to respect container width, not viewport */
.picanvas-tab-content[data-fullwidth-banner="false"] [data-automation-id="fullWidthImageLayout"] *,
.picanvas-tab-content[data-fullwidth-banner="false"] .picanvas-contained-banner * {
  max-width: 100% !important;
  margin-left: 0 !important;
  margin-right: 0 !important;
}

/* Override any calc() or vw-based widths in contained mode */
.picanvas-tab-content[data-fullwidth-banner="false"] [style*="100vw"],
.picanvas-tab-content[data-fullwidth-banner="false"] [style*="calc("] {
  width: 100% !important;
  max-width: 100% !important;
  margin-left: 0 !important;
  margin-right: 0 !important;
  left: 0 !important;
  transform: none !important;
}